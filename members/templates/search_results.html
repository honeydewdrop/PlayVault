{% extends "navbar.html" %}

{% block content %}
    <h1>Search Results for "{{ query }}"</h1>
    
    {% if page_obj %}
        <p>Found {{ total_results }} results</p>
        <ul>
            {% for game in page_obj %}
                <li>
                    <h2>
                        <a href="{% url 'game_detail' game.igdb_id %}">{{ game.name }}</a>
                    </h2>
                    {% if game.cover_url %}
                        <img src="{{ game.cover_url }}" alt="{{ game.name }}">
                    {% else %}
                        <p>No image available</p>
                    {% endif %}
                </li>
            {% empty %}
                <li>No games in this page (this shouldn't happen if total_results > 0)</li>
            {% endfor %}
        </ul>

        {% if page_obj.has_other_pages %}
            <div class="pagination">
                {% if page_obj.has_previous %}
                    <a href="?q={{ query }}&page={{ page_obj.previous_page_number }}">&laquo; Previous</a>
                {% endif %}

                {% for i in page_obj.paginator.page_range %}
                    {% if page_obj.number == i %}
                        <span class="current-page">{{ i }}</span>
                    {% else %}
                        <a href="?q={{ query }}&page={{ i }}">{{ i }}</a>
                    {% endif %}
                {% endfor %}

                {% if page_obj.has_next %}
                    <a href="?q={{ query }}&page={{ page_obj.next_page_number }}">Next &raquo;</a>
                {% endif %}
            </div>
        {% endif %}
    {% else %}
        <p>No games found matching your query.</p>
    {% endif %}
{% endblock %}